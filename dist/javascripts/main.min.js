function parseSeed(t){for(var e="",i=0;i<t.length;i++)for(var r in t[i])for(var s=0;s<t[i][r];s++)e+=r.toString();return e}function setup(){createCanvas(windowWidth,windowHeight),background(255);var t=new Grid(gridWidth,gridHeight,parseSeed(seed));t.populate(),t.automaton(),t.draw()}function Cell(t){this.color="#fff",this.state=0,this.position={x:t.x*cellWidth,y:t.y*cellHeight}}function Grid(t,e,i){this.w=t,this.h=e,this.cells=[],this.seed=i}var rule=57,seed=[{0:49},{1:1},{0:50}],gridWidth=100,gridHeight=100,ruleStart=24,cellWidth=10,cellHeight=10;Cell.prototype.setState=function(t){this.state=t,0==this.state?this.color="#fff":this.color="#000"},Cell.prototype.draw=function(){fill(this.color),rect(this.position.x,this.position.y,cellWidth,cellHeight)},Grid.prototype.draw=function(){fill("#fff"),noStroke(),rect(0,0,this.w*cellWidth,this.h*cellHeight);for(var t=0;t<this.cells.length;t++)this.cells[t].draw()},Grid.prototype.populate=function(){for(var t=0;t<this.h;t++)for(var e=0;e<this.w;e++)this.cells.push(new Cell({x:e,y:t})),t==ruleStart&&this.cells[this.cells.length-1].setState(parseInt(this.seed[e]))},Grid.prototype.automaton=function(){for(var t=0;t<this.h-1;t++)for(var e=-1;e<this.w-1;e++){var i={x:e,y:t},r=this.h*i.y+i.x;-1==e&&(r=this.h*i.y);var s=[this.cells[r],this.cells[r+1],this.cells[r+2]];e==this.w-2&&(s=[this.cells[r],this.cells[r],this.cells[r]]);var l=this.h*(i.y+1)+(i.x+1),h=this.cells[l];t+1!==ruleStart&&h.setState(function(t){for(var e=["111","110","101","100","011","010","001","000"],i=t[0].state.toString()+t[1].state.toString()+t[2].state.toString(),r=0;r<e.length;r++)if(i==e[r]){for(var s=rule.toString(2),l=e.length-s.length,h=0;h<l;h++)s="0"+s;return s[r]}}(s))}},$(document).ready(function(){});